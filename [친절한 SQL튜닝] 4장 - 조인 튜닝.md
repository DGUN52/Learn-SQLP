4.1 NL조인
- 
4.1.1 기본 메커니즘
- '입사일자'가 0월 0일 이후인 사원이 관리하는 '고객번호'를 찾고자 할 때
  - 입사일자가 0월 0일 이후인 사원의 사원번호를 찾는 것이 Outer loop이고
  - 고객의 관리사원번호가 해당 사원번호와 일치하는지를 찾는 것이 Ineer Loop이다.
- Outer쪽 테이블은 사이즈가 크지 않다면 인덱스를 이용하지 않을 수 있다.
  - Table Full Scan을 하더라도 한번에 그치기 때문
- 하지만 Inner쪽 테이블은 무조건 인덱스를 사용하여야 한다.

4.1.2 NL 조인 실행계획 제어
- select /*+ ordered use_nl(컬럼B) use_nl (컬럼C) use_hash(컬럼D)*/ *
  - B를 Inner Loop로 A와 조인하고, C와 조인할때도 NL로 조인하고, D와 조인할때는 해시방식을 이용한 것이다.
-  select /* use_nl(A,B,C,D) */ /일 경우 옵티마이저에게 실행계획을 맡긴다.

4.1.3 NL 조인 수행 과정 분석
- 각단계를 마무리하고 다음 단계로 넘어가는 것이 아닌 한 레코드씩 순차적으로 진행됨

-264p

4.1.4 NL 조인 튜닝 포인트
- NL조인의 절대일량은 첫 처리결과에 따라 달렸다.(첫 인덱스를 읽고난 후)
  - 처음 걸리는 조건의 양만큼 뒤의 조건들을 테이블 풀 스캔 해야하기 때문
- 일반적으로는
  - NL조인에서 과도한 랜덤 액세스가 발생하는 지점을 파악하고
  - 조인순서를 변경하거나 인덱스를 추가, 변경해서 랜덤액세스의 양을 줄일 수 있는지 검토한다.
  - 이와 같은 방식들이 충분하지 않을 때 소트머지조인, 해시조인을 검토
 
4.1.5 NL조인의 특징
- 랜덤 액세스 위주의 조인
  - 인덱스가 아무리 완벽해도 대량 데이터를 조인 시 불리하다.
- 한 레코드씩 순차적으로 진행
  - 대량 데이터 처리 시 매우 치명적으로 불리하지만
  - 아무리 큰 테이블을 조인하더라도 응답속도가 매우 빠르다는 장점을 가진다.(부분범위 처리)
- 다른 조인방식과 비교했을 때 인덱스 구성전략이 매우 중요하다.
- 위와 같은 특징들 때문에 소량데이터 및 부분범위 처리에 특화된 OLTP 시스템에 적합하다.

4.1.6 NL 조인 튜닝 실습
- 

4.1.7 NL조인 확장 메커니즘
- Prefetch기능
  - 인덱스를 이용해 테이블을 액세스하다가 IO가 생기면 다음에 읽게 될 블록까지 처리
- 배치IO기능
  - IO를 미루다가 일정량이 쌓이면 한꺼번에 처리










- 07.24(월) 255p ~ 
